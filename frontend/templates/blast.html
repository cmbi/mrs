{% extends "base.html" %}
{% block head %}

	<script src="static/js/select.js" type="text/javascript">
	</script>

	<script src="static/js/blast.js" type="text/javascript">
	</script>

{% endblock %}
{% block body %}
	<div id="main">
		<div style="margin-bottom: 1em;">
			<form id="blastForm" method="POST" action="/blast" onsubmit="BlastJobs.submit(); return false;"
				class="blast_form" >
				<fieldset>

<!--				<p class="reformatted">NOTE: Please check the reformatted sequence and resubmit</p>-->

					<p>Enter <em>one</em> protein sequence in <em>FastA</em> format</p>
					<textarea name="query" rows="5" cols="72">{{ query }}</textarea>
<!--					<li>Or enter filename: <input type="file" name="queryFile" size="50" maxlength="80" /></li>-->
					<div>
						<label for="db">Databank to search</label><select id="db" name="db" style="width:10em;">
                            {% for databank_name in all_databank_names %}
                                {% if is_blastable(databank_name) %}
                                    <option id="{{ databank_name }}" value="{{ databank_name }}" {% if databank_name==db %} selected="selected" {% endif %}>
                                        {{ databank_name }}
                                    </option>
                                {% endif %}
                            {% endfor %}
						</select>
					</div>
					
					<div id="options">
						<div>
                            <label for="filter">Filter low complexity</label>
                            <input type="checkbox" id="filter" checked="checked" name="filter" />
						</div>
						<div><label>E-value cutoff</label>
                            <select name="expect">
                                <option value="0.001">0.001</option>
                                <option value="0.01">0.01</option>
                                <option value="0.1">0.1</option>
                                <option value="1.0">1.0</option>
                                <option value="10.0" selected="selected">10.0</option>
                                <option value="100.0">100.0</option>
                                <option value="1000.0">1000.0</option>
                            </select>
                        </div>
					</div>

					<p class="hideOptions" style="float:left">advanced options</p>
					<div id="advancedoptions" style="display:none">
						<div><h3>Advanced options</h3></div>
						<div><label>Word size</label>
                            <select name="wordSize">
                                <option value="2" selected="selected">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
						    </select>
						</div>
						<div>
                            <label>Scoring matrix</label>
                            <select name="matrix" onchange="updateGapValues();">
                                <option value="BLOSUM45">BLOSUM45</option>
                                <option value="BLOSUM50">BLOSUM50</option>
                                <option value="BLOSUM62" selected="selected">BLOSUM62</option>
                                <option value="BLOSUM80">BLOSUM80</option>
                                <option value="BLOSUM90">BLOSUM90</option>
                                <option value="PAM30">PAM30</option>
                                <option value="PAM70">PAM70</option>
                                <option value="PAM250">PAM250</option>
						    </select>
						</div>
						<div>
                            <label for="gapped">Perform gapped alignment</label>
							<input id="gapped" type="checkbox" name="gapped" checked="checked" onchange="gappedChanged();"></input>
                        </div>
						<div><label>Cost to open a gap</label>
                            <select name="gapOpen" onchange="gapOpenChanged();">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5</option>
							<option value="6">6</option>
							<option value="7">7</option>
							<option value="8">8</option>
							<option value="9" selected="selected">9</option>
							<option value="10">10</option>
							<option value="11">11</option>
							<option value="12">12</option>
							<option value="13">13</option>
						    </select>
						</div>
						<div><label>Cost to extend a gap</label>
                            <select name="gapExtend" onchange="gapExtendChanged();">
                                <option value="1" selected="selected">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
						    </select>
						</div>
						<div><label>Limit reported hits</label>
                            <select name="reportLimit">
                                <option value="100">100</option>
                                <option value="250" selected="selected">250</option>
                                <option value="500">500</option>
                                <option value="1000">1000</option>
						    </select>
						</div>
					</div>

					<input type="hidden" name="program" value="blastp" />
					<div><input type="submit" name="submit" value="Run Blast" style="float:right;" class="submit"/></div>
				</fieldset>
			</form>

			<div style="display: inline-block; height: 20em; vertical-align: top; overflow-y: auto; overflow-x: hidden; width: 450px" >
			<table cellspacing="0" id="jobList" class="status clickable list" style="width:450; padding-right:16px">
				<caption>Blast results</caption>
				<thead>
					<tr>
						<th class="c1">Nr</th>
						<th class="c2">ID</th>
						<th class="c3">Databank</th>
						<th class="c45" colspan="2">Status</th>
					</tr>
				</thead>
	
				<tbody>
				<mrs:if test="${empty blastJobs}">
					<tr id="nohits">
						<td colspan="4">No blast results are available since no blast job has been submitted in this session.</td>
					</tr>
				</mrs:if>
				</tbody>
			</table>
			</div>
		</div>

		<div style="clear:both;">&#x00A0;</div>
		
		<div class="list" id='selectableList'>
			<table cellspacing="0" id="blastResult" style="display:none; width:100%">
				<caption>Blast results for</caption>
                <thead>
				    <tr>
					    <th colspan="2">Nr</th>
					    <th>ID</th>
					    <th>Coverage</th>
					    <th>Description</th>
					    <th>Hsps</th>
				    	<th>BitScore</th>
					    <th>E-value</th>
				    </tr>
                </thead>
				<tbody></tbody>
			</table>
		</div>
	</div>
	
	<mrs:include file="select.html" />
{% endblock %}
